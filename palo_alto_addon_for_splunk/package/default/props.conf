# Props.conf for Palo Alto Add-on for Splunk

# Palo Alto sourcetypes - enable XML parsing for events, JSON for metrics
# Note: Same sourcetype is used for both events (XML) and metrics (JSON)
# Splunk will auto-detect format based on content
[pan:log]
KV_MODE = auto
INDEXED_EXTRACTIONS = json

[pan:traffic]
KV_MODE = auto
INDEXED_EXTRACTIONS = json

[pan:threat]
KV_MODE = auto
INDEXED_EXTRACTIONS = json

[pan:system]
KV_MODE = auto
INDEXED_EXTRACTIONS = json

[pan:config]
KV_MODE = auto
INDEXED_EXTRACTIONS = json

[pan:session]
KV_MODE = auto
INDEXED_EXTRACTIONS = json

# Apply to modular input logs (these go to _internal index)
# Masks sensitive API keys in log entries using SEDCMD for in-place replacement
[source::...palo_alto_input.log*]
SEDCMD-mask_apikey = s/((?:^|&|\?)key=)([^&\s]+)/\1********/g

# Apply to any logs containing palo_alto_addon_for_splunk in the source
[source::...palo_alto_addon_for_splunk*.log*]
SEDCMD-mask_apikey = s/((?:^|&|\?)key=)([^&\s]+)/\1********/g

# Apply to splunkd logs that might contain our add-on logs
[source::...splunkd.log*]
SEDCMD-mask_apikey = s/((?:^|&|\?)key=)([^&\s]+)/\1********/g
